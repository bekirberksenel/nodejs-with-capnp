"use strict";
/**
 * @author jdiaz5513
 */
Object.defineProperty(exports, "__esModule", { value: true });
var capnp = require("../../lib");
var schema_capnp_1 = require("../../lib/std/schema.capnp");
var util_1 = require("../util");
var SCHEMA_MESSAGE = util_1.readFileBuffer("test/data/schema.bin");
var SCHEMA_FILE_ID = capnp.Int64.fromHexString("a93fc509624c72d9");
util_1.tap.test("schema roundtrip", function (t) {
    var message = new capnp.Message(SCHEMA_MESSAGE, false);
    var req = message.getRoot(schema_capnp_1.CodeGeneratorRequest);
    t.type(req, schema_capnp_1.CodeGeneratorRequest);
    var capnpVersion = req.getCapnpVersion();
    t.equal(capnpVersion.getMajor(), 0);
    t.equal(capnpVersion.getMinor(), 6);
    t.equal(capnpVersion.getMicro(), 0);
    var requestedFiles = req.getRequestedFiles();
    t.equal(requestedFiles.getLength(), 1);
    var requestedFile = requestedFiles.get(0);
    var filename = requestedFile.getFilename();
    t.equal(filename, "packages/capnp-ts/src/std/schema.capnp");
    var requestedFileId = requestedFile.getId();
    util_1.compareBuffers(t, requestedFileId.buffer.buffer, SCHEMA_FILE_ID.buffer.buffer);
    var out = message.toArrayBuffer();
    util_1.compareBuffers(t, out, SCHEMA_MESSAGE);
    t.end();
});

//# sourceMappingURL=schema.spec.js.map
